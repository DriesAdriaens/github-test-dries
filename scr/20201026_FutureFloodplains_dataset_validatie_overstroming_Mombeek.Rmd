---
title: "Dataset validatie overstromingen - Mombeek"
author: "Dries Adriaens"
date: "26-10-2020"
output:
  html_document:
    code_folding: hide
    toc: TRUE
    toc_float: TRUE
    toc_depth: 4
    number_sections: TRUE
    fig_width: 8
    fig_height: 5.7
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r libraries, echo=FALSE, message=FALSE, warning=FALSE}
library(watina)
library(ggplot2)
library(lubridate)
library(dplyr)
library(stringr)
library(tidyr)
library(sf)
library(leaflet)
```

```{r connection}
watina <- connect_watina()
```

# Meetpunten

We vragen al de meetpunten met peilbuis (piÃ«zometer) in de vallei van de Mombeek op met behulp van het R-package `Watina`.

```{r meetpunten}
locaties <- get_locs(watina,
                     area_codes = "MOM",
                     loc_type = c("P", "S"),
                     loc_validity = c("VLD", "ENT"),
                     filterdepth_guess = TRUE,
                     filterdepth_na = TRUE,
                     filterdepth_range = c(0, 30))
locaties %>% collect() %>% knitr::kable()
```
Histogram op basis van de diepte van de peilbuisfilters:
```{r}
locaties %>% 
  ggplot() +
  geom_histogram(aes(x = filterdepth))
```

## Raaien

```{r raaien}
trans_mom_1 <- c("MOMP005", "MOMP006", "MOMP007", "MOMP008", "MOMP009")
trans_mom_2 <- c("MOMP001", "MOMP003", "MOMP004", "MOMP010", "MOMP002",
                 "MOMP011", "MOMP029", "MOMP012", "MOMP013","MOMS001",
                 "MOMS009", "MOMP014",
                 "MOMP015", "MOMP016", "MOMS008", "MOMS002")
trans_mom_3 <- c("MOMP027", "MOMS011", "MOMP026", "MOMP025", "MOMP024",
                 "MOMP023", "MOMS007", "MOMS010", "MOMP017", "MOMP018",
                 "MOMP019", "MOMP020", "MOMP021", "MOMP022")
trans_mom_4 <- c("MOMP028")

locs <- locaties %>% collect()
transects <- data.frame(loc_code = locs$loc_code,
                        transect_nr = 0, stringsAsFactors = FALSE) %>% 
  mutate(transect_nr = ifelse(loc_code %in% trans_mom_1, 1,
                              ifelse(loc_code %in% trans_mom_2, 2,
                                     ifelse(loc_code %in% trans_mom_3, 3,
                                            ifelse(loc_code %in% trans_mom_4, 4,
                                                   transect_nr)))))
transects %>% knitr::kable()

locs <- locaties %>% collect() %>% 
  left_join(transects, by = "loc_code")
```
Overzichtskaartje van de peilbuizen en peilschalen, met aanduiding van de overstromingsgevoelige gebieden:

```{r}
pal <- colorFactor(palette = c("red", "blue"), domain = locs$loc_typecode)
leaflet(data = locs %>% 
  st_as_sf(coords = c("x", "y"), crs = 31370) %>% 
  st_transform(crs = 4326)) %>%
  addWMSTiles("https://wms.ngi.be/cartoweb/1/service?", layers = "cartoweb_topo",
              options = WMSTileOptions(format = "image/png", transparent = TRUE),
              group = "Cartoweb") %>% 
  addTiles(group = "OSM") %>%
  addWMSTiles("https://geoservices.informatievlaanderen.be/raadpleegdiensten/omwrgbmrvl/wms?",
              layers = "Ortho",
              options = WMSTileOptions(format = "image/png", transparent = TRUE),
              group = "Ortho_VL_winter") %>% 
  addWMSTiles("https://inspirepub.waterinfo.be/arcgis/services/Overstromingsgevoelige_gebieden_2017/MapServer/WMSServer?",
              layers = "0",
              options = WMSTileOptions(format = "image/png", transparent = TRUE, opacity = 0.5),
              group = "Overstromingsgevoelig") %>% 
  addWMSTiles("https://geoservices.informatievlaanderen.be/raadpleegdiensten/VMM/wms?",
              layers = "RecOvstrGeb",
              options = WMSTileOptions(format = "image/png", transparent = TRUE, opacity = 0.5),
              group = "Recent overstroomd") %>% 
  hideGroup("Recent overstroomd") %>% 
  addCircleMarkers(label = ~loc_code, fill = FALSE, weight = 3, color = ~pal(loc_typecode),
             labelOptions = labelOptions(noHide = TRUE, textOnly = FALSE,
                                         direction = "right", opacity = 0.75),
             group = "Meetpunten") %>% 
  addMiniMap(toggleDisplay = TRUE,zoomLevelOffset = -5) %>% 
  addLayersControl(
    baseGroups = c("OSM", "Ortho_VL_winter", "Cartoweb"),
    overlayGroups = c("Overstromingsgevoelig", "Recent overstroomd", "Meetpunten"),
    options = layersControlOptions(collapsed = FALSE)) %>% 
  addLegend(#pal = pal, values = ~loc_typecode,
            colors = c("red", "blue"), labels = c("grondwater", "oppervlaktewater"),
            group = "Meetpunten", title = "Meetpunttype")
```

# Tijdreeksen per raai

```{r tijdreeks}
tijdreeks <-
  locaties %>% 
  rename(mvTAW = soilsurf_ost) %>% 
  inner_join(tbl(watina, "FactPeilMeting"), by = c("loc_wid" = "MeetpuntWID")) %>% 
  inner_join(tbl(watina, "DimTijd"), by = c("TijdWID" = "DatumWID")) %>% 
  dplyr::collect()

tijdreeks <- tijdreeks %>% 
  left_join(transects, by = "loc_code")
```

Meetpunten met tijdreeksen met stijghoogten boven maaiveld:

```{r}
tijdreeks %>% 
  filter(mMaaiveld > 0) %>% 
  select(loc_code) %>% 
  distinct() %>% 
  left_join(transects, by = "loc_code") %>% 
  knitr::kable()
loc
```


## Raai 1

### Kaart

```{r kaart_raai_1}
leaflet(data = locs %>% 
  filter(transect_nr == 1) %>% 
  st_as_sf(coords = c("x", "y"), crs = 31370) %>% 
  st_transform(crs = 4326)) %>%
  addWMSTiles("https://wms.ngi.be/cartoweb/1/service?", layers = "cartoweb_topo",
              options = WMSTileOptions(format = "image/png", transparent = TRUE),
              group = "Cartoweb") %>% 
  addTiles(group = "OSM") %>%
  addWMSTiles("https://geoservices.informatievlaanderen.be/raadpleegdiensten/omwrgbmrvl/wms?",
              layers = "Ortho",
              options = WMSTileOptions(format = "image/png", transparent = TRUE),
              group = "Ortho_VL_winter") %>% 
  addCircleMarkers(label = ~loc_code, fill = FALSE, weight = 3, color = "red",
             labelOptions = labelOptions(noHide = TRUE, textOnly = FALSE,
                                         direction = "right", opacity = 0.75)) %>% 
  addMiniMap(toggleDisplay = TRUE,zoomLevelOffset = -5) %>% 
  addLayersControl(
    baseGroups = c("OSM", "Ortho_VL_winter", "Cartoweb"),
    overlayGroups = "Meetpunten",
    options = layersControlOptions(collapsed = FALSE)
  )
```

### Tijdreeks

m-mv

```{r tijdreeks_raai_1, message=FALSE, warning=FALSE}
ggplot(tijdreeks %>% 
         filter(transect_nr == 1 & loc_typecode != "S")) +
  geom_line(aes(x = date(Datum),
                y = mMaaiveld,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)"))) +
  ## non-clipping zoom
  # coord_cartesian(ylim = c(-1, 0.1),
  #                 xlim = c(ymd("2018-01-01"), ymd("2021-01-01"))
  #                 ) +
  scale_x_date(date_breaks = "year", date_labels = "%Y") +
  ## clipping zoom
  # xlim(ymd("2017-01-01"), ymd("2020-01-01")) +
  # ylim(-1, 0.1) +
  geom_hline(yintercept = 0, colour = "black", size = 1, linetype = "dotted") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
        panel.grid.minor.x = element_line(linetype = "dashed")) +
  labs(x = "Datum", y = "m-mv", colour = NULL)
```

m-mv, sinds 2017

```{r tijdreeks_raai_1_2017, message=FALSE, warning=FALSE}
ggplot(tijdreeks %>% 
         filter(transect_nr == 1 & loc_typecode != "S")) +
  geom_line(aes(x = date(Datum),
                y = mMaaiveld,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)"))) +
  ## non-clipping zoom
  # coord_cartesian(ylim = c(-1, 0.1),
  #                 xlim = c(ymd("2018-01-01"), ymd("2021-01-01"))
  #                 ) +
  scale_x_date(date_breaks = "year", date_labels = "%Y") +
  ## clipping zoom
  xlim(ymd("2017-01-01"), ymd("2020-01-01")) +
  # ylim(-1, 0.1) +
  geom_hline(yintercept = 0, colour = "black", size = 1, linetype = "dotted") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
        panel.grid.minor.x = element_line(linetype = "dashed")) +
  labs(x = "Datum", y = "m-mv", colour = NULL)
```

mTAW

```{r tijdreeks_raai_1_TAW, message=FALSE, warning=FALSE}
ggplot(tijdreeks %>% 
         filter(transect_nr == 1)) +
  geom_line(aes(x = date(Datum),
                y = mTAW,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)"))) +
  ## non-clipping zoom
  # coord_cartesian(ylim = c(-1, 0.1),
  #                 xlim = c(ymd("2018-01-01"), ymd("2021-01-01"))
  #                 ) +
  scale_x_date(date_breaks = "year", date_labels = "%Y") +
  ## clipping zoom
  # xlim(ymd("2017-01-01"), ymd("2020-01-01")) +
  # ylim(-1, 0.1) +
  geom_line(aes(x = date(Datum),
                y = mvTAW,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)")), linetype = "dashed") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
        panel.grid.minor.x = element_line(linetype = "dashed")) +
  labs(x = "Datum", y = "mTAW", colour = NULL)
```

mTAW, sinds 2017

```{r tijdreeks_raai_1_TAW_2017, message=FALSE, warning=FALSE}
ggplot(tijdreeks %>% 
         filter(transect_nr == 1)) +
  geom_line(aes(x = date(Datum),
                y = mTAW,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)"))) +
  ## non-clipping zoom
  # coord_cartesian(ylim = c(-1, 0.1),
  #                 xlim = c(ymd("2018-01-01"), ymd("2021-01-01"))
  #                 ) +
  scale_x_date(date_breaks = "year", date_labels = "%Y") +
  ## clipping zoom
  xlim(ymd("2017-01-01"), ymd("2020-01-01")) +
  # ylim(-1, 0.1) +
  geom_line(aes(x = date(Datum),
                y = mvTAW,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)")), linetype = "dashed") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
        panel.grid.minor.x = element_line(linetype = "dashed")) +
  labs(x = "Datum", y = "mTAW", colour = NULL)
```

## Raai 2

### Kaart

```{r kaart_raai_2}
leaflet(data = locs %>% 
  filter(transect_nr == 2) %>% 
  st_as_sf(coords = c("x", "y"), crs = 31370) %>% 
  st_transform(crs = 4326)) %>%
  addWMSTiles("https://wms.ngi.be/cartoweb/1/service?", layers = "cartoweb_topo",
              options = WMSTileOptions(format = "image/png", transparent = TRUE),
              group = "Cartoweb") %>% 
  addTiles(group = "OSM") %>%
  addWMSTiles("https://geoservices.informatievlaanderen.be/raadpleegdiensten/omwrgbmrvl/wms?",
              layers = "Ortho",
              options = WMSTileOptions(format = "image/png", transparant = TRUE),
              group = "Ortho_VL_winter") %>% 
  addCircleMarkers(label = ~loc_code, fill = FALSE, weight = 3, color = "red",
             labelOptions = labelOptions(noHide = TRUE, textOnly = FALSE,
                                         direction = "right", opacity = 0.75)) %>% 
  addMiniMap(toggleDisplay = TRUE,zoomLevelOffset = -5) %>% 
  addLayersControl(
    baseGroups = c("OSM", "Ortho_VL_winter", "Cartoweb"),
    overlayGroups = "Meetpunten",
    options = layersControlOptions(collapsed = FALSE)
  )
```

### Tijdreeks

m-mv

```{r tijdreeks_raai_2, message=FALSE, warning=FALSE}
ggplot(tijdreeks %>% 
         filter(transect_nr == 2)) +
  geom_line(aes(x = date(Datum),
                y = mMaaiveld,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)"))) +
  ## non-clipping zoom
  # coord_cartesian(ylim = c(-1, 0.1),
  #                 xlim = c(ymd("2018-01-01"), ymd("2021-01-01"))
  #                 ) +
  scale_x_date(date_breaks = "year", date_labels = "%Y") +
  ## clipping zoom
  # xlim(ymd("2017-01-01"), ymd("2020-01-01")) +
  # ylim(-1, 0.1) +
  geom_hline(yintercept = 0, colour = "black", size = 1, linetype = "dotted") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
        panel.grid.minor.x = element_line(linetype = "dashed")) +
  labs(x = "Datum", y = "m-mv", colour = NULL)
```

m-mv, sinds 2017

```{r tijdreeks_raai_2_2017, message=FALSE, warning=FALSE}
ggplot(tijdreeks %>% 
         filter(transect_nr == 2)) +
  geom_line(aes(x = date(Datum),
                y = mMaaiveld,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)"))) +
  ## non-clipping zoom
  # coord_cartesian(ylim = c(-1, 0.1),
  #                 xlim = c(ymd("2018-01-01"), ymd("2021-01-01"))
  #                 ) +
  scale_x_date(date_breaks = "year", date_labels = "%Y") +
  ## clipping zoom
  xlim(ymd("2017-01-01"), ymd("2020-01-01")) +
  # ylim(-1, 0.1) +
  geom_hline(yintercept = 0, colour = "black", size = 1, linetype = "dotted") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
        panel.grid.minor.x = element_line(linetype = "dashed")) +
  labs(x = "Datum", y = "m-mv", colour = NULL)
```

mTAW

```{r tijdreeks_raai_2_TAW, message=FALSE, warning=FALSE}
ggplot(tijdreeks %>% 
         filter(transect_nr == 2)) +
  geom_line(aes(x = date(Datum),
                y = mTAW,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)"))) +
  ## non-clipping zoom
  coord_cartesian(ylim = c(31.5, 34.5),
  #                 xlim = c(ymd("2018-01-01"), ymd("2021-01-01"))
                  ) +
  scale_x_date(date_breaks = "year", date_labels = "%Y") +
  ## clipping zoom
  # xlim(ymd("2017-01-01"), ymd("2020-01-01")) +
  # ylim(-1, 0.1) +
  geom_line(aes(x = date(Datum),
                y = mvTAW,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)")), linetype = "dashed") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
        panel.grid.minor.x = element_line(linetype = "dashed")) +
  labs(x = "Datum", y = "mTAW", colour = NULL)
```

mTAW, sinds 2017

```{r tijdreeks_raai_1_TAW_2017, message=FALSE, warning=FALSE}
ggplot(tijdreeks %>% 
         filter(transect_nr == 1)) +
  geom_line(aes(x = date(Datum),
                y = mTAW,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)"))) +
  ## non-clipping zoom
  coord_cartesian(ylim = c(31, 35.25),
  #                 xlim = c(ymd("2018-01-01"), ymd("2021-01-01"))
                  ) +
  scale_x_date(date_breaks = "year", date_labels = "%Y") +
  ## clipping zoom
  xlim(ymd("2017-01-01"), ymd("2020-01-01")) +
  # ylim(-1, 0.1) +
  geom_line(aes(x = date(Datum),
                y = mvTAW,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)")), linetype = "dashed") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
        panel.grid.minor.x = element_line(linetype = "dashed")) +
  labs(x = "Datum", y = "mTAW", colour = NULL)
```

## Raai 3

### Kaart

```{r kaart_raai_3}
leaflet(data = locs %>% 
  filter(transect_nr == 3) %>% 
  st_as_sf(coords = c("x", "y"), crs = 31370) %>% 
  st_transform(crs = 4326)) %>%
  addWMSTiles("https://wms.ngi.be/cartoweb/1/service?", layers = "cartoweb_topo",
              options = WMSTileOptions(format = "image/png", transparent = TRUE),
              group = "Cartoweb") %>% 
  addTiles(group = "OSM") %>%
  addWMSTiles("https://geoservices.informatievlaanderen.be/raadpleegdiensten/omwrgbmrvl/wms?",
              layers = "Ortho",
              options = WMSTileOptions(format = "image/png", transparant = TRUE),
              group = "Ortho_VL_winter") %>% 
  addCircleMarkers(label = ~loc_code, fill = FALSE, weight = 3, color = "red",
             labelOptions = labelOptions(noHide = TRUE, textOnly = FALSE,
                                         direction = "right", opacity = 0.75)) %>% 
  addMiniMap(toggleDisplay = TRUE,zoomLevelOffset = -5) %>% 
  addLayersControl(
    baseGroups = c("OSM", "Ortho_VL_winter", "Cartoweb"),
    overlayGroups = "Meetpunten",
    options = layersControlOptions(collapsed = FALSE)
  )
```

### Tijdreeks

m-mv

```{r tijdreeks_raai_3, message=FALSE, warning=FALSE}
ggplot(tijdreeks %>% 
         filter(transect_nr == 3 & loc_typecode != "S")) +
  geom_line(aes(x = date(Datum),
                y = mMaaiveld,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)"))) +
  ## non-clipping zoom
  # coord_cartesian(ylim = c(-1, 0.1),
  #                 xlim = c(ymd("2018-01-01"), ymd("2021-01-01"))
  #                 ) +
  scale_x_date(date_breaks = "year", date_labels = "%Y") +
  ## clipping zoom
  # xlim(ymd("2017-01-01"), ymd("2020-01-01")) +
  # ylim(-1, 0.1) +
  geom_hline(yintercept = 0, colour = "black", size = 1, linetype = "dotted") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
        panel.grid.minor.x = element_line(linetype = "dashed")) +
  labs(x = "Datum", y = "m-mv", colour = NULL)
```

m-mv, sinds 2017

```{r tijdreeks_raai_3_2017, message=FALSE, warning=FALSE}
ggplot(tijdreeks %>% 
         filter(transect_nr == 3 & loc_typecode != "S")) +
  geom_line(aes(x = date(Datum),
                y = mMaaiveld,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)"))) +
  ## non-clipping zoom
  # coord_cartesian(ylim = c(-1, 0.1),
  #                 xlim = c(ymd("2018-01-01"), ymd("2021-01-01"))
  #                 ) +
  scale_x_date(date_breaks = "year", date_labels = "%Y") +
  ## clipping zoom
  xlim(ymd("2017-01-01"), ymd("2020-01-01")) +
  # ylim(-1, 0.1) +
  geom_hline(yintercept = 0, colour = "black", size = 1, linetype = "dotted") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
        panel.grid.minor.x = element_line(linetype = "dashed")) +
  labs(x = "Datum", y = "m-mv", colour = NULL)
```

mTAW

```{r tijdreeks_raai_3_TAW, message=FALSE, warning=FALSE}
ggplot(tijdreeks %>% 
         filter(transect_nr == 3)) +
  geom_line(aes(x = date(Datum),
                y = mTAW,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)"))) +
  ## non-clipping zoom
  coord_cartesian(ylim = c(34, 37.5),
  #                 xlim = c(ymd("2018-01-01"), ymd("2021-01-01"))
                  ) +
  scale_x_date(date_breaks = "year", date_labels = "%Y") +
  ## clipping zoom
  # xlim(ymd("2017-01-01"), ymd("2020-01-01")) +
  # ylim(-1, 0.1) +
  geom_line(aes(x = date(Datum),
                y = mvTAW,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)")), linetype = "dashed") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
        panel.grid.minor.x = element_line(linetype = "dashed")) +
  labs(x = "Datum", y = "mTAW", colour = NULL)
```

mTAW, sinds 2017

```{r tijdreeks_raai_3_TAW_2017, message=FALSE, warning=FALSE}
ggplot(tijdreeks %>% 
         filter(transect_nr == 3)) +
  geom_line(aes(x = date(Datum),
                y = mTAW,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)"))) +
  ## non-clipping zoom
  coord_cartesian(ylim = c(34, 37.5),
  #                 xlim = c(ymd("2018-01-01"), ymd("2021-01-01"))
                  ) +
  scale_x_date(date_breaks = "year", date_labels = "%Y") +
  ## clipping zoom
  xlim(ymd("2017-01-01"), ymd("2020-01-01")) +
  # ylim(-1, 0.1) +
  geom_line(aes(x = date(Datum),
                y = mvTAW,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)")), linetype = "dashed") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
        panel.grid.minor.x = element_line(linetype = "dashed")) +
  labs(x = "Datum", y = "mTAW", colour = NULL)
```

## Raai 4

### Kaart

```{r kaart_raai_4}
leaflet(data = locs %>% 
  filter(transect_nr == 4) %>% 
  st_as_sf(coords = c("x", "y"), crs = 31370) %>% 
  st_transform(crs = 4326)) %>%
  addWMSTiles("https://wms.ngi.be/cartoweb/1/service?", layers = "cartoweb_topo",
              options = WMSTileOptions(format = "image/png", transparent = TRUE),
              group = "Cartoweb") %>% 
  addTiles(group = "OSM") %>%
  addWMSTiles("https://geoservices.informatievlaanderen.be/raadpleegdiensten/omwrgbmrvl/wms?",
              layers = "Ortho",
              options = WMSTileOptions(format = "image/png", transparant = TRUE),
              group = "Ortho_VL_winter") %>% 
  addCircleMarkers(label = ~loc_code, fill = FALSE, weight = 3, color = "red",
             labelOptions = labelOptions(noHide = TRUE, textOnly = FALSE,
                                         direction = "right", opacity = 0.75)) %>% 
  addMiniMap(toggleDisplay = TRUE,zoomLevelOffset = -5) %>% 
  addLayersControl(
    baseGroups = c("OSM", "Ortho_VL_winter", "Cartoweb"),
    overlayGroups = "Meetpunten",
    options = layersControlOptions(collapsed = FALSE)
  )
```

### Tijdreeks

m-mv

```{r tijdreeks_raai_4, message=FALSE, warning=FALSE}
ggplot(tijdreeks %>% 
         filter(transect_nr == 4 & loc_typecode != "S")) +
  geom_line(aes(x = date(Datum),
                y = mMaaiveld,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)"))) +
  ## non-clipping zoom
  # coord_cartesian(ylim = c(-1, 0.1),
  #                 xlim = c(ymd("2018-01-01"), ymd("2021-01-01"))
  #                 ) +
  scale_x_date(date_breaks = "year", date_labels = "%Y") +
  ## clipping zoom
  # xlim(ymd("2017-01-01"), ymd("2020-01-01")) +
  # ylim(-1, 0.1) +
  geom_hline(yintercept = 0, colour = "black", size = 1, linetype = "dotted") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
        panel.grid.minor.x = element_line(linetype = "dashed")) +
  labs(x = "Datum", y = "m-mv", colour = NULL)
```

mTAW

```{r tijdreeks_raai_4_TAW, message=FALSE, warning=FALSE}
ggplot(tijdreeks %>% 
         filter(transect_nr == 4)) +
  geom_line(aes(x = date(Datum),
                y = mTAW,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)"))) +
  ## non-clipping zoom
  # coord_cartesian(ylim = c(34, 37.5),
  #                 xlim = c(ymd("2018-01-01"), ymd("2021-01-01"))
                  # ) +
  scale_x_date(date_breaks = "year", date_labels = "%Y") +
  ## clipping zoom
  # xlim(ymd("2017-01-01"), ymd("2020-01-01")) +
  # ylim(-1, 0.1) +
  geom_line(aes(x = date(Datum),
                y = mvTAW,
                colour = paste0(loc_code, " (", round(mvTAW,2), " mTAW)")), linetype = "dashed") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5),
        panel.grid.minor.x = element_line(linetype = "dashed")) +
  labs(x = "Datum", y = "mTAW", colour = NULL)
```


